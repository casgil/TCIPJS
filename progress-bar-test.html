<!DOCTYPE html>
<html>
<head>
    <title>Progress Bar Timing Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .test-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.1s ease-out;
            border-radius: 10px;
        }
        .timer {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            text-align: center;
            margin: 10px 0;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #2980b9;
        }
    </style>
</head>
<body>
    <h1>Progress Bar Timing Test</h1>
    <p>This test verifies that the progress bar animation matches the actual delay time.</p>
    
    <div class="test-container">
        <h3>Test 1: 5 Second Delay (Circle - First Choice)</h3>
        <div class="timer" id="timer1">0.0s</div>
        <div class="progress-bar">
            <div class="progress" id="progress1"></div>
        </div>
        <button onclick="startTest(1, 5000)">Start 5-Second Test</button>
    </div>
    
    <div class="test-container">
        <h3>Test 2: 15 Second Delay (Square Choice)</h3>
        <div class="timer" id="timer2">0.0s</div>
        <div class="progress-bar">
            <div class="progress" id="progress2"></div>
        </div>
        <button onclick="startTest(2, 15000)">Start 15-Second Test</button>
    </div>
    
    <div class="test-container">
        <h3>Test 3: 10 Second Delay (Circle - Later Choice)</h3>
        <div class="timer" id="timer3">0.0s</div>
        <div class="progress-bar">
            <div class="progress" id="progress3"></div>
        </div>
        <button onclick="startTest(3, 10000)">Start 10-Second Test</button>
    </div>

    <script>
        function startTest(testNumber, duration) {
            const progressBar = document.getElementById(`progress${testNumber}`);
            const timer = document.getElementById(`timer${testNumber}`);
            
            // Reset
            progressBar.style.width = '0%';
            timer.textContent = '0.0s';
            
            console.log(`Starting test ${testNumber} with duration: ${duration}ms`);
            
            const startTime = Date.now();
            let progress = 0;
            
            // Calculate correct timing: 100% over the full duration
            const totalSteps = 100; // 100 steps to reach 100%
            const stepDuration = duration / totalSteps; // Time per step in milliseconds
            const increment = 100 / totalSteps; // Progress increment per step (1%)
            
            const interval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                progress += increment;
                
                progressBar.style.width = `${Math.min(progress, 100)}%`;
                timer.textContent = `${(elapsed / 1000).toFixed(1)}s`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    console.log(`Test ${testNumber} completed in ${elapsed}ms (expected: ${duration}ms)`);
                    timer.textContent = `Completed in ${(elapsed / 1000).toFixed(1)}s`;
                }
            }, stepDuration);
        }
        
        // Auto-start first test
        setTimeout(() => {
            startTest(1, 5000);
        }, 1000);
    </script>
</body>
</html>
